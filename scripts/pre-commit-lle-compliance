#!/bin/bash
# Pre-commit hook for LLE architectural compliance
# Install with: ln -s ../../scripts/pre-commit-lle-compliance .git/hooks/pre-commit

# Only run if LLE files are being committed
LLE_FILES=$(git diff --cached --name-only | grep "^src/lle/foundation/")

if [ -z "$LLE_FILES" ]; then
    # No LLE files being committed, skip check
    exit 0
fi

echo "LLE files detected in commit, running architectural compliance check..."
echo ""

# Run compliance check
if ! ./scripts/lle_architectural_compliance_check.sh; then
    echo ""
    echo "=========================================="
    echo "COMMIT BLOCKED: Architectural Violations"
    echo "=========================================="
    echo ""
    echo "LLE code contains architectural violations."
    echo "Fix violations before committing."
    echo ""
    echo "To bypass (NOT RECOMMENDED):"
    echo "  git commit --no-verify"
    echo ""
    exit 1
fi

echo ""
echo "âœ“ Architectural compliance verified"
echo ""
exit 0
