# Function definition compatibility
# Function syntax and features

[func_posix]
category = "syntax"
feature = "function_definition"
description = "POSIX function definition name()"

[func_posix.behavior]
posix = "POSIX defined - name() compound-command"
bash = "Same as POSIX"
zsh = "Same as POSIX"
lush = "POSIX compliant"

[func_posix.lint]
severity = "info"
message = "POSIX function syntax is portable"
suggestion = "POSIX compliant"
pattern = "^[A-Za-z_][A-Za-z0-9_]*\\s*\\(\\)\\s*\\{"

[func_keyword]
category = "syntax"
feature = "function_keyword"
description = "Function keyword function name"

[func_keyword.behavior]
posix = "Not in POSIX"
bash = "function name { ... } or function name() { ... }"
zsh = "Same as bash"
lush = "Bash-compatible"

[func_keyword.lint]
severity = "warning"
message = "function keyword is not portable"
suggestion = "Use name() { ... } for POSIX compatibility"
pattern = "\\bfunction\\s+[A-Za-z_][A-Za-z0-9_]*"

[func_local]
category = "syntax"
feature = "function_local"
description = "Local variables in functions"

[func_local.behavior]
posix = "Not in POSIX (but widely supported)"
bash = "local var=value"
zsh = "local var=value or typeset var=value"
lush = "Bash-compatible local"

[func_local.lint]
severity = "warning"
message = "local is not strictly POSIX"
suggestion = "local is widely available but not in POSIX; variables are global by default"
pattern = "\\blocal\\s+"

[func_return]
category = "syntax"
feature = "function_return"
description = "Return from function"

[func_return.behavior]
posix = "POSIX defined - return [n]"
bash = "Same as POSIX"
zsh = "Same as POSIX"
lush = "POSIX compliant"

[func_return.lint]
severity = "info"
message = "return is portable"
suggestion = "POSIX compliant; value 0-255"
pattern = "\\breturn\\b"

[func_recursion]
category = "syntax"
feature = "function_recursion"
description = "Recursive function calls"

[func_recursion.behavior]
posix = "POSIX defined"
bash = "Same as POSIX"
zsh = "Same as POSIX"
lush = "POSIX compliant"

[func_recursion.lint]
severity = "info"
message = "Recursive functions are portable"
suggestion = "POSIX compliant"
pattern = ""

[func_nameref]
category = "syntax"
feature = "function_nameref"
description = "Nameref for pass-by-reference"

[func_nameref.behavior]
posix = "Not in POSIX"
bash = "declare -n or local -n (bash 4.3+)"
zsh = "Different approach with (P) flag"
lush = "Bash-compatible nameref"

[func_nameref.lint]
severity = "warning"
message = "Nameref is not portable"
suggestion = "bash 4.3+; use eval for portable pass-by-reference"
pattern = "\\b(declare|local)\\s+-n\\b"

[func_compound]
category = "syntax"
feature = "function_compound"
description = "Function with non-brace compound command"

[func_compound.behavior]
posix = "POSIX allows any compound command after ()"
bash = "Same as POSIX"
zsh = "Same as POSIX"
lush = "POSIX compliant"

[func_compound.lint]
severity = "info"
message = "Compound command functions are portable"
suggestion = "POSIX allows: name() (subshell), name() for..."
pattern = "^[A-Za-z_][A-Za-z0-9_]*\\s*\\(\\)\\s*\\("

[func_export]
category = "syntax"
feature = "function_export"
description = "Exported functions"

[func_export.behavior]
posix = "Not in POSIX"
bash = "export -f name"
zsh = "Functions not exported; use FPATH/autoload"
lush = "Bash-compatible export -f"

[func_export.lint]
severity = "warning"
message = "Function export is not portable"
suggestion = "bash-specific; zsh uses autoload/FPATH"
pattern = "\\bexport\\s+-f\\b"

[func_autoload]
category = "syntax"
feature = "function_autoload"
description = "Autoloaded functions"

[func_autoload.behavior]
posix = "Not in POSIX"
bash = "No built-in autoload"
zsh = "autoload -Uz name with FPATH"
lush = "Supports autoload for zsh compatibility"

[func_autoload.lint]
severity = "warning"
message = "autoload is zsh-specific"
suggestion = "zsh feature; bash sources functions explicitly"
pattern = "\\bautoload\\b"
